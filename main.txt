$global:ParsedFileName;
$global:ParsedContents;
$global:PathPatch = @{};

function PatchBrokenPath($PreviousFileName){

  Write-Host "[PathFixer]";
  Write-Host "Trying to fix..."
  $PathPatch

}

# Main Function
function ParseFile($FileName, $ReturnOutput=$false, $PatchPath=$false){
  Try{
    $global:ParsedFileName = [string]$FileName;

      $global:ParsedContents = [string](cat -raw $FileName);
      $CodeExec = ( ($ParsedContents) | Out-String );
      Invoke-Expression($CodeExec);
      return $true, $CodeExec
  } Catch {
    if($_.Exception.Message -eq "Path Broken"){PatchBrokenPath($FileName);}
    else{if($ReturnOutput){return $false, $_.Exception;}}
  }
}



# Function for use in shortcut, uses short name ('i') to save space.
function i($FileName, $ReturnState=$false){
  $State, $Error = ParseFile($FileName);

  if(!$State){Write-Host $Error;}
  if($ReturnState){
    return $State, $Error
  }
}

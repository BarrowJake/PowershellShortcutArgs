$global:ParsedFileName;
$global:ParsedContents;

# Main Function
function ParseFile($FileName, $ReturnOutput=$false){
  Try{
    $global:ParsedFileName = [string]$FileName;
    $global:ParsedContents = [string](cat -raw $FileName);
    $CodeExec = ( ($ParsedContents+" 2>&1") | Out-String );
    Invoke-Expression($CodeExec);
  } Catch {
    return $false, $_.Exception;
  }
}

# Function for use in shortcut, uses short name ('i') to save space.
function i($FileName, $ReturnState=$false){
  $State, $Error = ParseFile($FileName);
  Write-Host $Error;
  if($ReturnState){
    return $State, $Error
  }
}

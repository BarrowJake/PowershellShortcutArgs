$global:ParsedFileName;
$global:ParsedContents;

function PatchBrokenPath($PreviousFileName){
  Write-Host "[PathFixer]"
  Write-Host (Get-History)
  $CommandHistory = Get-History | Select-Object -Property CommandLine
  $Initial = $CommandHistory[0]
}

# Main Function
function ParseFile($FileName, $ReturnOutput=$false){
  Try{
    $global:ParsedFileName = [string]$FileName;
    if(Test-Path $FileName){
      $global:ParsedContents = [string](cat -raw $FileName);
      $CodeExec = ( ($ParsedContents+" 2>&1") | Out-String );
      Invoke-Expression($CodeExec);
      return $true, $CodeExec
    } else {
      PatchBrokenPath($FileName);
      #if($ReturnOutput){return $false, "Not a valid path";}
    }
  } Catch {
    if($ReturnOutput){return $false, $_.Exception;}
  }
}



# Function for use in shortcut, uses short name ('i') to save space.
function i($FileName, $ReturnState=$false){
  $State, $Error = ParseFile($FileName);
  Write-Host $Error;
  if($ReturnState){
    return $State, $Error
  }
}
